
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as M}from"./index-74c80a46.js";import{_ as W}from"./index-c4dfb300.js";import{_ as j}from"./index.vue_vue_type_script_setup_true_name_SvgIcon_lang-dfa84782.js";import{a as Y}from"./index-e71fcdfa.js";import{bb as _,a$ as c}from"./user-2b228075.js";import{N as v}from"./index-9f392a3c.js";import{b as N}from"./route-block-83d24a4e.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import{a3 as o,k as g,l as D,E as e,y as l,C as m,m as w,F as V,Y as E,D as H,x as q}from"./runtime-core.esm-bundler-a63aef9e.js";import"./settings-58b03ff3.js";import"./index-c228ae8f.js";import"./vue-router-8228f7a0.js";import"./runtime-dom.esm-bundler-1ceaee55.js";const z={data(){return{showEditDialog:!1,showCreateDialog:!1,batchBtnEnable:!1,search:{pageSize:20,pageIndex:1,queryParams:{deptId:null,phoneNumber:null,account:null,name:null}},queryUserRespData:{list:[],currPage:1,pageSize:20,total:0,totalPage:0},departmentTree:{},roleList:[],selectedRoles:[],selectedRows:[],editUserDetail:{},createUserDetail:{},editFieldRules:{name:[{required:!0,message:"用户姓名必填",trigger:"blur"}],account:[{required:!0,message:"用户账号必填",trigger:"blur"}]}}},computed:{},mounted(){this.clickSearch(),this.loadDepartmentTree(),this.loadRoles()},methods:{loadRoles(){_.get("server/role/getRoles").then(r=>{this.roleList=r.data})},loadDepartmentTree(){_.get("server/dept/getDeptTree").then(r=>{this.departmentTree=r.data})},clickSearch(){_.post("server/user/getUserDetails",this.search).then(r=>{this.queryUserRespData=r.data})},resetSearch(){this.search.queryParams={deptId:null,phoneNumber:null,account:null,name:null},this.clickSearch()},handleClick(){console.log("click")},handleSizeChange(r){this.search.pageSize=r,this.clickSearch()},handleCurrentChange(r){this.search.pageIndex=r,this.clickSearch()},getSelectedRows(r){this.selectedRows=r,this.selectedRows&&this.selectedRows.length!==0?this.batchBtnEnable=!0:this.batchBtnEnable=!1},deleteSelection(r){v.confirm("确定要删除所选用户吗？此操作不可恢复！","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const a=[];for(let d=0;d<this.selectedRows.length;d++){const k=this.selectedRows[d];a.push(k.account)}_.get(`server/user/deleteUsers?accounts=${a}`).then(d=>{d.code===0?c({type:"success",message:"删除成功"}):c({type:"error",message:`删除失败：${d.message}`}),this.clickSearch()})}).catch(()=>{})},deleteSingle(r){v.confirm("确定要删除此用户吗？此操作不可恢复！","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.get(`server/user/deleteUser?account=${r.account}`).then(a=>{a.code===0?c({type:"success",message:"删除成功"}):c({type:"error",message:`删除失败：${a.message}`}),this.clickSearch()})}).catch(()=>{})},editSingle(r){_.get(`server/user/getUserDetail?account=${r.account}`).then(a=>{this.editUserDetail=a.data,this.selectedRoles=[];for(let d=0;d<this.editUserDetail.roles.length;d++)this.selectedRoles.push(this.editUserDetail.roles[d].id);this.showEditDialog=!0}).catch(a=>{c({type:"error",message:`编辑失败：${a}`})})},saveEditOperation(){this.$refs.editUserDetailForm.validate(r=>{r?_.post("server/user/modifyUser",{account:this.editUserDetail.account,name:this.editUserDetail.name,departmentId:this.editUserDetail.department.id,phoneNumber:this.editUserDetail.phoneNumber,roles:this.selectedRoles}).then(a=>{a.code===0?(c({type:"success",message:"保存成功"}),this.showEditDialog=!1,this.clickSearch()):c({type:"error",message:`编辑失败：${a.message}`})}):c({type:"error",message:"参数内容填写有误，请检查"})})},cancelEditOperation(){this.showEditDialog=!1},createUser(){this.createUserDetail={account:"",name:"",password:"",phoneNumber:""},this.selectedRoles=[],this.showCreateDialog=!0},cancelCreateOperation(){this.showCreateDialog=!1},saveCreateOperation(){this.$refs.createUserDetailForm.validate(r=>{r?(this.createUserDetail.roles=this.selectedRoles,_.post("server/user/createUser",this.createUserDetail).then(a=>{a.code===0?(c({type:"success",message:"保存成功"}),this.showCreateDialog=!1,this.clickSearch()):c({type:"error",message:`保存失败：${a.message}`})})):c({type:"error",message:"参数内容填写有误，请检查"})})}}};const J={class:"button-group"},K={class:"dialog-footer"},Q={class:"dialog-footer"};function X(r,a,d,k,t,i){const P=Y,h=o("el-input"),s=o("el-form-item"),n=o("el-col"),U=o("el-tree-select"),T=o("el-row"),F=j,y=o("el-icon"),p=o("el-button"),C=o("el-form"),A=W,B=M,f=o("el-table-column"),I=o("el-tag"),O=o("el-table"),L=o("el-pagination"),x=o("el-option"),R=o("el-select"),S=o("el-dialog");return g(),D("div",null,[e(P,{title:"用户管理",content:"本页面提供对系统内用户数据的整体维护管理能力，可以新增用户或者删除用户操作，或者对已有用户信息进行变更。"}),e(B,{title:"搜索条件"},{default:l(()=>[e(A,null,{default:l(()=>[e(C,{model:t.search,size:"default","label-width":"120px"},{default:l(()=>[e(T,null,{default:l(()=>[e(n,{span:6},{default:l(()=>[e(s,{label:"姓名"},{default:l(()=>[e(h,{modelValue:t.search.queryParams.name,"onUpdate:modelValue":a[0]||(a[0]=u=>t.search.queryParams.name=u),placeholder:"输入用户姓名查询",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(s,{label:"账号"},{default:l(()=>[e(h,{modelValue:t.search.queryParams.account,"onUpdate:modelValue":a[1]||(a[1]=u=>t.search.queryParams.account=u),placeholder:"输入用户账号查询",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(s,{label:"手机号"},{default:l(()=>[e(h,{modelValue:t.search.queryParams.phoneNumber,"onUpdate:modelValue":a[2]||(a[2]=u=>t.search.queryParams.phoneNumber=u),placeholder:"手机号查询",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:6},{default:l(()=>[e(s,{label:"部门"},{default:l(()=>[e(U,{modelValue:t.search.queryParams.deptId,"onUpdate:modelValue":a[3]||(a[3]=u=>t.search.queryParams.deptId=u),data:t.departmentTree,"render-after-expand":!1,"check-strictly":"true"},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1}),e(s,null,{default:l(()=>[e(p,{type:"primary",onClick:i.clickSearch},{icon:l(()=>[e(y,null,{default:l(()=>[e(F,{name:"ep:search"})]),_:1})]),default:l(()=>[m(" 查询 ")]),_:1},8,["onClick"]),e(p,{onClick:i.resetSearch},{default:l(()=>[m(" 重置 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(B,null,{default:l(()=>[w("div",J,[e(p,{type:"primary",onClick:i.createUser},{icon:l(()=>[e(y,null,{default:l(()=>[e(F,{name:"ep:circle-plus"})]),_:1})]),default:l(()=>[m(" 新建 ")]),_:1},8,["onClick"]),e(p,{type:"danger",disabled:!t.batchBtnEnable,onClick:i.deleteSelection},{icon:l(()=>[e(y,null,{default:l(()=>[e(F,{name:"ep:delete"})]),_:1})]),default:l(()=>[m(" 删除所选 ")]),_:1},8,["disabled","onClick"])]),e(O,{border:"","highlight-current-row":"",data:t.queryUserRespData.list,height:"100%",onSelectionChange:i.getSelectedRows},{default:l(()=>[e(f,{type:"selection",width:"55"}),e(f,{fixed:"",prop:"name",label:"姓名",width:"150"}),e(f,{prop:"account",label:"账号",width:"120"}),e(f,{prop:"phoneNumber",label:"手机号",width:"120"}),e(f,{prop:"department.name",label:"部门",width:"120"}),e(f,{prop:"roles",label:"角色"},{default:l(u=>[(g(!0),D(V,null,E(u.row.roles,(b,Z)=>(g(),D("span",{key:b.id},[e(I,{class:"tag-style"},{default:l(()=>[m(H(b.roleName),1)]),_:2},1024)]))),128))]),_:1}),e(f,{fixed:"right",label:"操作",width:"200"},{default:l(u=>[e(p,{link:"",type:"primary",size:"small",onClick:b=>i.editSingle(u.row)},{default:l(()=>[m(" 编辑 ")]),_:2},1032,["onClick"]),e(p,{link:"",type:"danger",size:"small",onClick:b=>i.deleteSingle(u.row)},{default:l(()=>[m(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"]),e(L,{class:"pageination-style",background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":t.queryUserRespData.pageSize,total:t.queryUserRespData.total,"current-page":t.queryUserRespData.currPage,onSizeChange:i.handleSizeChange,onCurrentChange:i.handleCurrentChange},null,8,["page-size","total","current-page","onSizeChange","onCurrentChange"])]),_:1}),e(S,{modelValue:t.showEditDialog,"onUpdate:modelValue":a[9]||(a[9]=u=>t.showEditDialog=u),title:"编辑用户信息"},{footer:l(()=>[w("span",K,[e(p,{onClick:i.cancelEditOperation},{default:l(()=>[m(" 取消 ")]),_:1},8,["onClick"]),e(p,{type:"primary",onClick:i.saveEditOperation},{default:l(()=>[m(" 保存 ")]),_:1},8,["onClick"])])]),default:l(()=>[e(C,{ref:"editUserDetailForm",model:t.editUserDetail,size:"default","label-width":"120px",rules:t.editFieldRules},{default:l(()=>[e(n,{span:18},{default:l(()=>[e(s,{label:"账号"},{default:l(()=>[e(h,{modelValue:t.editUserDetail.account,"onUpdate:modelValue":a[4]||(a[4]=u=>t.editUserDetail.account=u),placeholder:"用户账号",readonly:"",disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:18},{default:l(()=>[e(s,{label:"姓名",prop:"name",rules:t.editFieldRules.name},{default:l(()=>[e(h,{modelValue:t.editUserDetail.name,"onUpdate:modelValue":a[5]||(a[5]=u=>t.editUserDetail.name=u),placeholder:"用户姓名",maxlength:"64","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:18},{default:l(()=>[e(s,{label:"手机号"},{default:l(()=>[e(h,{modelValue:t.editUserDetail.phoneNumber,"onUpdate:modelValue":a[6]||(a[6]=u=>t.editUserDetail.phoneNumber=u),placeholder:"手机号",clearable:"",maxlength:"32","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(s,{label:"部门"},{default:l(()=>[e(U,{modelValue:t.editUserDetail.department.id,"onUpdate:modelValue":a[7]||(a[7]=u=>t.editUserDetail.department.id=u),data:t.departmentTree,"render-after-expand":!1,"check-strictly":"true"},null,8,["modelValue","data"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(s,{label:"角色"},{default:l(()=>[e(R,{modelValue:t.selectedRoles,"onUpdate:modelValue":a[8]||(a[8]=u=>t.selectedRoles=u),multiple:"",placeholder:"Select",style:{width:"440px"}},{default:l(()=>[(g(!0),D(V,null,E(t.roleList,u=>(g(),q(x,{key:u.id,label:u.roleName,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(S,{modelValue:t.showCreateDialog,"onUpdate:modelValue":a[15]||(a[15]=u=>t.showCreateDialog=u),title:"新建用户"},{footer:l(()=>[w("span",Q,[e(p,{onClick:i.cancelCreateOperation},{default:l(()=>[m(" 取消 ")]),_:1},8,["onClick"]),e(p,{type:"primary",onClick:i.saveCreateOperation},{default:l(()=>[m(" 保存 ")]),_:1},8,["onClick"])])]),default:l(()=>[e(C,{ref:"createUserDetailForm",model:t.createUserDetail,size:"default","label-width":"120px",rules:t.editFieldRules},{default:l(()=>[e(n,{span:18},{default:l(()=>[e(s,{label:"账号",prop:"account",rules:t.editFieldRules.account},{default:l(()=>[e(h,{modelValue:t.createUserDetail.account,"onUpdate:modelValue":a[10]||(a[10]=u=>t.createUserDetail.account=u),placeholder:"输入用户账号",maxlength:"64","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:18},{default:l(()=>[e(s,{label:"姓名",prop:"name",rules:t.editFieldRules.name},{default:l(()=>[e(h,{modelValue:t.createUserDetail.name,"onUpdate:modelValue":a[11]||(a[11]=u=>t.createUserDetail.name=u),placeholder:"输入用户姓名",maxlength:"64","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:18},{default:l(()=>[e(s,{label:"手机号"},{default:l(()=>[e(h,{modelValue:t.createUserDetail.phoneNumber,"onUpdate:modelValue":a[12]||(a[12]=u=>t.createUserDetail.phoneNumber=u),placeholder:"手机号",clearable:"",maxlength:"32","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(s,{label:"部门"},{default:l(()=>[e(U,{modelValue:t.createUserDetail.departmentId,"onUpdate:modelValue":a[13]||(a[13]=u=>t.createUserDetail.departmentId=u),data:t.departmentTree,"render-after-expand":!1,"check-strictly":"true"},null,8,["modelValue","data"])]),_:1})]),_:1}),e(n,{span:24},{default:l(()=>[e(s,{label:"角色"},{default:l(()=>[e(R,{modelValue:t.selectedRoles,"onUpdate:modelValue":a[14]||(a[14]=u=>t.selectedRoles=u),multiple:"",placeholder:"Select",style:{width:"440px"}},{default:l(()=>[(g(!0),D(V,null,E(t.roleList,u=>(g(),q(x,{key:u.id,label:u.roleName,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}typeof N=="function"&&N(z);const me=G(z,[["render",X],["__scopeId","data-v-f4296fe7"]]);export{me as default};
//# sourceMappingURL=user-mgt-63ba2c5f.js.map
