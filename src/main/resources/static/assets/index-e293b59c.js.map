{"version":3,"file":"index-e293b59c.js","sources":["../../src/layouts/components/Topbar/index.vue"],"sourcesContent":["<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nexport default defineComponent({\n  name: 'Topbar',\n})\n</script>\n<script lang=\"ts\" setup name=\"Topbar\">\r\nimport { compile } from 'path-to-regexp'\r\nimport Tools from '../Tools/index.vue'\r\nimport useSettingsStore from '@/store/modules/settings'\r\n\r\nconst route = useRoute()\r\n\r\nconst settingsStore = useSettingsStore()\r\n\r\nconst enableSubMenuCollapseButton = computed(() => {\r\n  return settingsStore.mode === 'mobile' || (\r\n    ['side', 'head', 'single'].includes(settingsStore.settings.menu.menuMode)\r\n      && settingsStore.settings.menu.enableSubMenuCollapseButton\r\n  )\r\n})\r\n\r\nconst breadcrumbList = computed(() => {\r\n  const breadcrumbList = []\r\n  if (settingsStore.settings.home.enable) {\r\n    breadcrumbList.push({\r\n      path: '/',\r\n      title: settingsStore.settings.home.title,\r\n    })\r\n  }\r\n  if (route.meta.breadcrumbNeste) {\r\n    breadcrumbList.push(...route.meta.breadcrumbNeste.filter(item => item.hide === false))\r\n  }\r\n  return breadcrumbList\r\n})\r\n\r\nconst scrollTop = ref(0)\r\nconst scrollOnHide = ref(false)\r\nonMounted(() => {\r\n  window.addEventListener('scroll', onScroll)\r\n})\r\nonUnmounted(() => {\r\n  window.removeEventListener('scroll', onScroll)\r\n})\r\nfunction onScroll() {\r\n  scrollTop.value = (document.documentElement || document.body).scrollTop\r\n}\r\nwatch(scrollTop, (val, oldVal) => {\r\n  const topbarHeight = parseInt(getComputedStyle(document.documentElement || document.body).getPropertyValue('--g-topbar-height'))\r\n  scrollOnHide.value = settingsStore.settings.topbar.mode === 'sticky' && val > oldVal && val > topbarHeight\r\n})\r\n\r\nfunction pathCompile(path: string) {\r\n  const toPath = compile(path)\r\n  return toPath(route.params)\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div\r\n    class=\"topbar-container\" :class=\"{\r\n      [`topbar-${settingsStore.settings.topbar.mode}`]: true,\r\n      shadow: scrollTop,\r\n      hide: scrollOnHide,\r\n    }\" data-fixed-calc-width\r\n  >\r\n    <div class=\"left-box\">\r\n      <div v-if=\"enableSubMenuCollapseButton\" class=\"sidebar-collapse\" :class=\"{ 'is-collapse': settingsStore.settings.menu.subMenuCollapse }\" @click=\"settingsStore.toggleSidebarCollapse()\">\r\n        <el-icon>\r\n          <svg-icon name=\"toolbar-collapse\" />\r\n        </el-icon>\r\n      </div>\r\n      <el-breadcrumb v-if=\"settingsStore.settings.breadcrumb.enable && settingsStore.mode === 'pc' && settingsStore.settings.app.routeBaseOn !== 'filesystem'\">\r\n        <transition-group name=\"breadcrumb\">\r\n          <el-breadcrumb-item v-for=\"(item, index) in breadcrumbList\" :key=\"item.path\" :to=\"index < breadcrumbList.length - 1 ? pathCompile(item.path) : ''\">\r\n            {{ item.title ?? '[ 无标题 ]' }}\r\n          </el-breadcrumb-item>\r\n        </transition-group>\r\n      </el-breadcrumb>\r\n    </div>\r\n    <Tools />\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n.topbar-container {\r\n  position: absolute;\r\n  z-index: 999;\r\n  top: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  height: var(--g-topbar-height);\r\n  background-color: var(--g-toolbar-bg);\r\n  transition: width 0.3s, top 0.3s, transform 0.3s, background-color 0.3s, var(--el-transition-box-shadow);\r\n\r\n  &.topbar-fixed,\r\n  &.topbar-sticky {\r\n    position: fixed;\r\n\r\n    &.shadow {\r\n      box-shadow: 0 10px 10px -10px var(--g-box-shadow-color);\r\n    }\r\n  }\r\n\r\n  &.topbar-sticky.hide {\r\n    top: calc(var(--g-topbar-height) * -1) !important;\r\n  }\r\n\r\n  .left-box {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 50px;\r\n    overflow: hidden;\r\n    mask-image: linear-gradient(90deg, #000 0%, #000 calc(100% - 50px), transparent);\r\n\r\n    .sidebar-collapse {\r\n      display: flex;\r\n      align-items: center;\r\n      padding: 0 20px;\r\n      height: 50px;\r\n      cursor: pointer;\r\n\r\n      .el-icon {\r\n        color: var(--el-text-color-primary);\r\n        transition: var(--el-transition-color), var(--el-transition-md-fade);\r\n      }\r\n\r\n      &:hover .el-icon {\r\n        color: var(--el-color-primary);\r\n      }\r\n\r\n      &.is-collapse .el-icon {\r\n        transform: rotateZ(-180deg);\r\n      }\r\n\r\n      & + .el-breadcrumb {\r\n        margin-left: 0;\r\n      }\r\n    }\r\n\r\n    :deep(.el-breadcrumb) {\r\n      margin-left: 20px;\r\n      white-space: nowrap;\r\n\r\n      .el-breadcrumb__item {\r\n        display: inline-block;\r\n        float: none;\r\n\r\n        span {\r\n          font-weight: normal;\r\n        }\r\n\r\n        &:last-child span {\r\n          color: #97a8be;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 面包屑动画\r\n.breadcrumb-enter-active {\r\n  transition: all 0.25s;\r\n}\r\n\r\n.breadcrumb-enter-from,\r\n.breadcrumb-leave-active {\r\n  opacity: 0;\r\n  transform: translateX(30px) skewX(-50deg);\r\n}\r\n</style>\r\n"],"names":["__default__","defineComponent","route","useRoute","settingsStore","useSettingsStore","enableSubMenuCollapseButton","computed","breadcrumbList","breadcrumbList2","item","scrollTop","ref","scrollOnHide","onMounted","onScroll","onUnmounted","watch","val","oldVal","topbarHeight","pathCompile","path","compile"],"mappings":"owBAEAA,EAAAC,EAAA,CAA+B,KAAA,QAE/B,CAAA,qBAOA,MAAAC,EAAAC,IAEAC,EAAAC,IAEAC,EAAAC,EAAA,IACEH,EAAA,OAAA,UAAA,CAAA,OAAA,OAAA,QAAA,EAAA,SAAAA,EAAA,SAAA,KAAA,QAAA,GAAAA,EAAA,SAAA,KAAA,2BAEmC,EAIrCI,EAAAD,EAAA,IAAA,CACE,MAAAE,EAAA,CAAA,EACA,OAAAL,EAAA,SAAA,KAAA,QACEK,EAAA,KAAA,CAAoB,KAAA,IACZ,MAAAL,EAAA,SAAA,KAAA,KAC6B,CAAA,EAGvCF,EAAA,KAAA,iBACEO,EAAA,KAAA,GAAAP,EAAA,KAAA,gBAAA,OAAAQ,GAAAA,EAAA,OAAA,EAAA,CAAA,EAEFD,CAAO,CAAA,EAGTE,EAAAC,EAAA,CAAA,EACAC,EAAAD,EAAA,EAAA,EACAE,EAAA,IAAA,CACE,OAAA,iBAAA,SAAAC,CAAA,CAA0C,CAAA,EAE5CC,EAAA,IAAA,CACE,OAAA,oBAAA,SAAAD,CAAA,CAA6C,CAAA,EAE/C,SAAAA,GAAA,CACEJ,EAAA,OAAA,SAAA,iBAAA,SAAA,MAAA,SAA8D,CAEhEM,EAAAN,EAAA,CAAAO,EAAAC,IAAA,CACE,MAAAC,EAAA,SAAA,iBAAA,SAAA,iBAAA,SAAA,IAAA,EAAA,iBAAA,mBAAA,CAAA,EACAP,EAAA,MAAAT,EAAA,SAAA,OAAA,OAAA,UAAAc,EAAAC,GAAAD,EAAAE,CAA8F,CAAA,EAGhG,SAAAC,EAAAC,EAAA,CAEE,OADAC,EAAAD,CAAA,EACApB,EAAA,MAAA,CAA0B"}