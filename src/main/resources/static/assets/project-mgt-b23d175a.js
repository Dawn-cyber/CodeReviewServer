
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as N}from"./index-74c80a46.js";import{_ as P}from"./index-c4dfb300.js";import{_ as R}from"./index.vue_vue_type_script_setup_true_name_SvgIcon_lang-dfa84782.js";import{a as T}from"./index-e71fcdfa.js";import{bb as _,a$ as s}from"./user-2b228075.js";import{N as j}from"./index-9f392a3c.js";import{b as k}from"./route-block-83d24a4e.js";import{_ as q}from"./_plugin-vue_export-helper-c27b6911.js";import{a3 as i,k as U,l as O,E as e,y as t,C as d,m as C}from"./runtime-core.esm-bundler-a63aef9e.js";import"./settings-58b03ff3.js";import"./index-c228ae8f.js";import"./vue-router-8228f7a0.js";import"./runtime-dom.esm-bundler-1ceaee55.js";const V={data(){return{showEditDialog:!1,showCreateDialog:!1,batchBtnEnable:!1,search:{queryParams:{deptId:null}},departmentTree:{},projectList:[],selectedRows:[],editDetail:{},createDetail:{},editFieldRules:{projectName:[{required:!0,message:"项目名称必填",trigger:"blur"}]}}},computed:{},mounted(){this.clickSearch(),this.loadDepartmentTree()},methods:{loadProjects(){const o=this.search.queryParams.deptId?this.search.queryParams.deptId:0;_.get(`server/project/queryProjectInDept?deptId=${o}`).then(l=>{this.projectList=l.data})},loadDepartmentTree(){_.get("server/dept/getDeptTree").then(o=>{this.departmentTree=o.data})},clickSearch(){this.loadProjects()},resetSearch(){this.search.queryParams={deptId:null},this.clickSearch()},getSelectedRows(o){this.selectedRows=o,this.selectedRows&&this.selectedRows.length!==0?this.batchBtnEnable=!0:this.batchBtnEnable=!1},deleteSelection(o){j.confirm("确定要删除所选项目吗？此操作不可恢复！","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=[];for(let m=0;m<this.selectedRows.length;m++){const w=this.selectedRows[m];l.push(w.id)}_.get(`server/project/deleteProjects?projectIds=${l}`).then(m=>{m.code===0?s({type:"success",message:"删除成功"}):s({type:"error",message:`删除失败：${m.message}`}),this.clickSearch()})}).catch(()=>{})},deleteSingle(o){j.confirm("确定要删除此项目吗？此操作不可恢复！","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.get(`server/project/deleteProject?projectId=${o.id}`).then(l=>{l.code===0?s({type:"success",message:"删除成功"}):s({type:"error",message:`删除失败：${l.message}`}),this.clickSearch()})}).catch(()=>{})},editSingle(o){_.get(`server/project/queryProject?projectId=${o.id}`).then(l=>{this.editDetail={projectName:l.data.projectName,projectDesc:l.data.projectDesc,departmentId:l.data.department.id,id:l.data.id},this.showEditDialog=!0}).catch(l=>{s({type:"error",message:`编辑失败：${l}`})})},saveEditOperation(){this.$refs.editDetailForm.validate(o=>{o?_.post(`server/project/modifyProject?projId=${this.editDetail.id}`,this.editDetail).then(l=>{l.code===0?(s({type:"success",message:"保存成功"}),this.showEditDialog=!1,this.clickSearch()):s({type:"error",message:`编辑失败：${l.message}`})}):s({type:"error",message:"参数内容填写有误，请检查"})})},cancelEditOperation(){this.showEditDialog=!1},create(){this.createDetail={projectName:"",projectDesc:""},this.showCreateDialog=!0},cancelCreateOperation(){this.showCreateDialog=!1},saveCreateOperation(){this.$refs.createDetailForm.validate(o=>{o?_.post("server/project/createProject",this.createDetail).then(l=>{l.code===0?(s({type:"success",message:"保存成功"}),this.showCreateDialog=!1,this.clickSearch()):s({type:"error",message:`保存失败：${l.message}`})}):s({type:"error",message:"参数内容填写有误，请检查"})})}}};const A={class:"button-group"},z={class:"dialog-footer"},M={class:"dialog-footer"};function L(o,l,m,w,a,r){const B=T,E=i("el-tree-select"),c=i("el-form-item"),p=i("el-col"),g=R,D=i("el-icon"),n=i("el-button"),x=i("el-row"),F=i("el-form"),v=P,y=N,f=i("el-table-column"),I=i("el-table"),h=i("el-input"),b=i("el-dialog");return U(),O("div",null,[e(B,{title:"项目管理",content:"本页面提供对系统内所有的项目信息进行维护，项目需要绑定到部门，支持按照部门维度筛选自己部门内的项目列表。"}),e(y,{title:"搜索条件"},{default:t(()=>[e(v,null,{default:t(()=>[e(F,{model:a.search,size:"default","label-width":"120px"},{default:t(()=>[e(x,null,{default:t(()=>[e(p,{span:6},{default:t(()=>[e(c,{label:"归属部门"},{default:t(()=>[e(E,{modelValue:a.search.queryParams.deptId,"onUpdate:modelValue":l[0]||(l[0]=u=>a.search.queryParams.deptId=u),data:a.departmentTree,"render-after-expand":!1,"check-strictly":"true"},null,8,["modelValue","data"])]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(n,{type:"primary",onClick:r.clickSearch},{icon:t(()=>[e(D,null,{default:t(()=>[e(g,{name:"ep:search"})]),_:1})]),default:t(()=>[d(" 查询 ")]),_:1},8,["onClick"]),e(n,{onClick:r.resetSearch},{default:t(()=>[d(" 重置 ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[C("div",A,[e(n,{type:"primary",onClick:r.create},{icon:t(()=>[e(D,null,{default:t(()=>[e(g,{name:"ep:circle-plus"})]),_:1})]),default:t(()=>[d(" 新建 ")]),_:1},8,["onClick"]),e(n,{type:"danger",disabled:!a.batchBtnEnable,onClick:r.deleteSelection},{icon:t(()=>[e(D,null,{default:t(()=>[e(g,{name:"ep:delete"})]),_:1})]),default:t(()=>[d(" 删除所选 ")]),_:1},8,["disabled","onClick"])]),e(I,{border:"","highlight-current-row":"",data:a.projectList,height:"100%",onSelectionChange:r.getSelectedRows},{default:t(()=>[e(f,{type:"selection",width:"55"}),e(f,{fixed:"",prop:"id",label:"项目ID",width:"100"}),e(f,{prop:"projectName",label:"项目名称",width:"360"}),e(f,{prop:"department.name",label:"归属部门",width:"200"}),e(f,{prop:"projectDesc",label:"项目描述"}),e(f,{fixed:"right",label:"操作",width:"200"},{default:t(u=>[e(n,{link:"",type:"primary",size:"small",onClick:S=>r.editSingle(u.row)},{default:t(()=>[d(" 编辑 ")]),_:2},1032,["onClick"]),e(n,{link:"",type:"danger",size:"small",onClick:S=>r.deleteSingle(u.row)},{default:t(()=>[d(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])]),_:1}),e(b,{modelValue:a.showEditDialog,"onUpdate:modelValue":l[5]||(l[5]=u=>a.showEditDialog=u),title:"编辑项目信息"},{footer:t(()=>[C("span",z,[e(n,{onClick:r.cancelEditOperation},{default:t(()=>[d(" 取消 ")]),_:1},8,["onClick"]),e(n,{type:"primary",onClick:r.saveEditOperation},{default:t(()=>[d(" 保存 ")]),_:1},8,["onClick"])])]),default:t(()=>[e(F,{ref:"editDetailForm",model:a.editDetail,size:"default","label-width":"120px",rules:a.editFieldRules},{default:t(()=>[e(p,{span:18},{default:t(()=>[e(c,{label:"项目ID"},{default:t(()=>[e(h,{modelValue:a.editDetail.id,"onUpdate:modelValue":l[1]||(l[1]=u=>a.editDetail.id=u),readonly:"",disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:18},{default:t(()=>[e(c,{label:"项目名称",prop:"projectName",rules:a.editFieldRules.projectName},{default:t(()=>[e(h,{modelValue:a.editDetail.projectName,"onUpdate:modelValue":l[2]||(l[2]=u=>a.editDetail.projectName=u),placeholder:"输入项目的名称",maxlength:"64","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(p,{span:24},{default:t(()=>[e(c,{label:"归属部门"},{default:t(()=>[e(E,{modelValue:a.editDetail.departmentId,"onUpdate:modelValue":l[3]||(l[3]=u=>a.editDetail.departmentId=u),data:a.departmentTree,"render-after-expand":!1,"check-strictly":"true"},null,8,["modelValue","data"])]),_:1})]),_:1}),e(p,{span:18},{default:t(()=>[e(c,{label:"项目描述"},{default:t(()=>[e(h,{modelValue:a.editDetail.projectDesc,"onUpdate:modelValue":l[4]||(l[4]=u=>a.editDetail.projectDesc=u),type:"textarea",rows:3,placeholder:"输入项目的简要描述信息",clearable:"",maxlength:"32","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(b,{modelValue:a.showCreateDialog,"onUpdate:modelValue":l[9]||(l[9]=u=>a.showCreateDialog=u),title:"创建项目信息"},{footer:t(()=>[C("span",M,[e(n,{onClick:r.cancelCreateOperation},{default:t(()=>[d(" 取消 ")]),_:1},8,["onClick"]),e(n,{type:"primary",onClick:r.saveCreateOperation},{default:t(()=>[d(" 保存 ")]),_:1},8,["onClick"])])]),default:t(()=>[e(F,{ref:"createDetailForm",model:a.createDetail,size:"default","label-width":"120px",rules:a.editFieldRules},{default:t(()=>[e(p,{span:18},{default:t(()=>[e(c,{label:"项目名称",prop:"projectName",rules:a.editFieldRules.projectName},{default:t(()=>[e(h,{modelValue:a.createDetail.projectName,"onUpdate:modelValue":l[6]||(l[6]=u=>a.createDetail.projectName=u),placeholder:"输入项目的名称",maxlength:"64","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(p,{span:24},{default:t(()=>[e(c,{label:"归属部门"},{default:t(()=>[e(E,{modelValue:a.createDetail.departmentId,"onUpdate:modelValue":l[7]||(l[7]=u=>a.createDetail.departmentId=u),data:a.departmentTree,"render-after-expand":!1,"check-strictly":"true"},null,8,["modelValue","data"])]),_:1})]),_:1}),e(p,{span:18},{default:t(()=>[e(c,{label:"项目描述"},{default:t(()=>[e(h,{modelValue:a.createDetail.projectDesc,"onUpdate:modelValue":l[8]||(l[8]=u=>a.createDetail.projectDesc=u),type:"textarea",rows:3,placeholder:"输入项目的简要描述信息",clearable:"",maxlength:"32","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}typeof k=="function"&&k(V);const ae=q(V,[["render",L],["__scopeId","data-v-c7b13344"]]);export{ae as default};
//# sourceMappingURL=project-mgt-b23d175a.js.map
